<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
   <link rel="stylesheet" href="/stylesheets/admin.css">
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar">
        <h3 class="text-center">Management Panel</h3>
        <a href="javascript:void(0);" class="nav-link" onclick="showSection('manageDoctors')"><i class="bi bi-person-fill"></i> Doctors</a>
        <a href="javascript:void(0);" class="nav-link" onclick="showSection('manageNurses')"><i class="bi bi-person-check-fill"></i> Nurses</a>
        <a href="javascript:void(0);" class="nav-link" onclick="showSection('managePharmacists')"><i class="bi bi-capslock"></i> Pharmacists</a>
        <!-- <a href="javascript:void(0);" class="nav-link" onclick="showSection('manageReceptionists')"><i class="bi bi-house-door-fill"></i> Receptionists</a> -->
        <a href="javascript:void(0);" class="nav-link" onclick="showSection('managePatients')"><i class="bi bi-person-bounding-box"></i> Patients</a>
        <a href="javascript:void(0);" class="nav-link" onclick="showSection('manageSurgery')"><i class="bi bi-hospital"></i> Surgery Management</a>
        <a href="javascript:void(0);" class="nav-link" onclick="showSection('manageRoom')">
            <i class="bi bi-door-open"></i> Room Management
        </a>
        <a href="/logout"> <i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <h1>Admin Dashboard</h1>
        
        <!-- Doctor Management Section -->
        <section id="manageDoctors" class="container mt-5 section-content" style="display:none;">
            <h2 class="section-title mb-4">Manage Doctors</h2>
            
            <!-- Button to toggle form visibility -->
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addDoctorModal">Add New Doctor</button>

            <!-- Table to display doctors -->
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Specialization</th>
                        <th>services</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (doctors && doctors.length > 0) { %>
                        <% doctors.forEach((doctor) => { %>
                          <% if (doctor && doctor.user) { %> <!-- Kiểm tra nếu doctor và doctor.user đều tồn tại -->
                            <tr>
                              <td><%= doctor.user.fullname %></td>
                              <td><%= doctor.specialization %></td>
                              <td><%= doctor.service ? doctor.service.name : 'N/A' %></td> <!-- Kiểm tra nếu doctor.service tồn tại -->
                              <td>
                                <button class="btn btn-warning btn-sm">
                                  <a href="admin/doctor/view/<%= doctor._id %>">View</a>
                                </button>
                              </td>
                            </tr>
                          <% } else { %>
                            <!-- Nếu doctor hoặc doctor.user không tồn tại -->
                            <tr>
                              <td colspan="4" class="text-center">Doctor information unavailable</td>
                            </tr>
                          <% } %>
                        <% }) %>
                      <% } else { %>
                        <tr>
                          <td colspan="4" class="text-center">No doctors available</td>
                        </tr>
                      <% } %>                      
                </tbody>
            </table>

            <!-- Modal for adding new doctor -->
            <div class="modal fade" id="addDoctorModal" tabindex="-1" aria-labelledby="addDoctorModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header bg-primary text-white">
                            <h5 class="modal-title" id="addDoctorModalLabel">
                                <i class="fas fa-user-md"></i> Add New Doctor
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="/admin/doctor/add" method="post">
                                <div class="mb-3">
                                    <label for="doctorName" class="form-label">Fullname</label>
                                    <input type="text" class="form-control" id="doctorName" name="fullname" placeholder="Enter doctor's name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="doctorEmail" class="form-label">Email</label>
                                    <input type="text" class="form-control" id="doctorEmail" name="email" placeholder="Enter doctor's email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="doctorSpecialization" class="form-label">Specialization</label>
                                    <input type="text" class="form-control" id="doctorSpecialization" name="specialization" placeholder="Enter specialization" required>
                                </div>
                                <div class="mb-3">
                                    <label for="doctorMedicalService" class="form-label">Medical Service</label>
                                    <select class="form-select" id="doctorMedicalService" name="service" required>
                                        <option value="" disabled selected>Select a medical service</option>
                                        <%
                                            if(medicalServices && medicalServices.length > 0){
                                                medicalServices.forEach((item)=>{
                                                    %>
                                                    <option value="<%=item._id%>"><%=item.name%></option>
                                                    <%
                                                })
                                            }
                                        %>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i> Save Doctor
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- Nurse Management Section -->
        <section id="manageNurses" class="container mt-5 section-content" style="display:none;">
            <h2 class="section-title">Manage Nurses</h2>
            <!-- Button to toggle form visibility -->
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addNurseModal">Add New Nurse</button>

            <!-- Table to display doctors -->
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Department</th>
                        <th>Shift</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (nurses && nurses.length > 0) { %>
                        <% nurses.forEach((nurse) => { %>
                          <% if (nurse && nurse.user) { %> <!-- Kiểm tra nếu nurse và nurse.user tồn tại -->
                            <tr>
                              <td><%= nurse.user.fullname %></td>
                              <td><%= nurse.department || 'N/A' %></td> <!-- Kiểm tra nếu department tồn tại, nếu không trả về 'N/A' -->
                              <td><%= nurse.shift || 'N/A' %></td> <!-- Kiểm tra nếu shift tồn tại, nếu không trả về 'N/A' -->
                              <td>
                                <button class="btn btn-warning btn-sm">
                                  <a href="admin/nurse/view/<%= nurse._id %>">View</a>
                                </button>
                              </td>
                            </tr>
                          <% } else { %>
                            <!-- Nếu nurse hoặc nurse.user không tồn tại -->
                            <tr>
                              <td colspan="4" class="text-center">Nurse information unavailable</td>
                            </tr>
                          <% } %>
                        <% }) %>
                      <% } else { %>
                        <tr>
                          <td colspan="4" class="text-center">No nurses available</td>
                        </tr>
                      <% } %>
                      
                </tbody>
            </table>

            <!-- Modal for adding new doctor -->
            <div class="modal fade" id="addNurseModal" tabindex="-1" aria-labelledby="addNurseModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header bg-primary text-white">
                            <h5 class="modal-title" id="addNurseModalLabel">
                                <i class="fas fa-user-nurse"></i> Add New Nurse
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="/admin/nurse/add" method="post">
                                <div class="mb-3">
                                    <label for="nurseName" class="form-label">Fullname</label>
                                    <input type="text" class="form-control" id="nurseName" name="fullname" placeholder="Enter nurse's name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nurseEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="nurseEmail" name="email" placeholder="Enter nurse's email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nurseDepartment" class="form-label">Department</label>
                                    <input type="text" class="form-control" id="nurseDepartment" name="department" placeholder="Enter department" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nurseShift" class="form-label">Shift</label>
                                    <select class="form-select" id="nurseShift" name="shift" required>
                                        <option value="" disabled selected>Select shift</option>
                                        <option value="morning">Morning</option>
                                        <option value="afternoon">Afternoon</option>
                                        <option value="night">Night</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i> Save Nurse
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <!-- Pharmacist Management Section -->
        <section id="managePharmacists" class="container mt-5 section-content" style="display:none;">
            <h2 class="section-title">Manage Pharmacists</h2>
            <!-- Button to toggle form visibility -->
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addPharmacistModal">Add New Pharmacist</button>

            <!-- Table to display doctors -->
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>License Number</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (pharmacists && pharmacists.length > 0) { %>
                        <% pharmacists.forEach((pharmacist) => { %>
                          <% if (pharmacist && pharmacist.user) { %> <!-- Kiểm tra nếu pharmacist và pharmacist.user tồn tại -->
                            <tr>
                              <td><%= pharmacist.user.fullname || 'N/A' %></td> <!-- Nếu fullname không tồn tại, hiển thị 'N/A' -->
                              <td><%= pharmacist.licenseNumber || 'N/A' %></td> <!-- Nếu licenseNumber không tồn tại, hiển thị 'N/A' -->
                              <td>
                                <button class="btn btn-warning btn-sm">
                                  <a href="admin/pharmacist/view/<%= pharmacist._id %>">View</a>
                                </button>
                              </td>
                            </tr>
                          <% } else { %>
                          <% } %>
                        <% }) %>
                      <% } else { %>
                        <tr>
                          <td colspan="3" class="text-center">No pharmacists available</td>
                        </tr>
                      <% } %>
                      
                </tbody>
            </table>

            <!-- Modal for adding new Pharmacist -->
            <div class="modal fade" id="addPharmacistModal" tabindex="-1" aria-labelledby="addPharmacistModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header bg-primary text-white">
                            <h5 class="modal-title" id="addPharmacistModalLabel">
                                <i class="fas fa-user-pharmacist"></i> Add New Pharmacist
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="/admin/pharmacist/add" method="post">
                                <div class="mb-3">
                                    <label for="pharmacistName" class="form-label">Fullname</label>
                                    <input type="text" class="form-control" id="pharmacistName" name="fullname" placeholder="Enter pharmacist's name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="pharmacistEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="pharmacistEmail" name="email" placeholder="Enter pharmacist's email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="pharmacistLicenseNumber" class="form-label">License Number</label>
                                    <input type="text" class="form-control" id="pharmacistLicenseNumber" name="licenseNumber" placeholder="Enter license number" required>
                                </div>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i> Save Pharmacist
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <!-- Receptionist Management Section -->
        <section id="manageReceptionists" class="container mt-5 section-content" style="display:none;">
            <h2 class="section-title">Manage Receptionists</h2>
            <!-- Button to toggle form visibility -->
            <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addReceptionistModal">Add New Receptionist</button>

            <!-- Table to display doctors -->
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Department</th>
                        <th>Shift</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (receptionists && receptionists.length > 0) { %>
                        <% receptionists.forEach((receptionist) => { %>
                          <% if (receptionist && receptionist.user) { %> <!-- Kiểm tra nếu receptionist và receptionist.user tồn tại -->
                            <tr>
                              <td><%= receptionist.user.fullname || 'N/A' %></td> <!-- Nếu fullname không tồn tại, hiển thị 'N/A' -->
                              <td><%= receptionist.department || 'N/A' %></td> <!-- Nếu department không tồn tại, hiển thị 'N/A' -->
                              <td><%= receptionist.shift || 'N/A' %></td> <!-- Nếu shift không tồn tại, hiển thị 'N/A' -->
                              <td>
                                <button class="btn btn-warning btn-sm">
                                  <a href="admin/receptionist/view/<%= receptionist._id %>">View</a>
                                </button>
                              </td>
                            </tr>
                          <% } else { %>
                            <!-- Nếu receptionist hoặc receptionist.user không tồn tại -->
                            <tr>
                              <td colspan="3" class="text-center">Receptionist information unavailable</td>
                            </tr>
                          <% } %>
                        <% }) %>
                      <% } else { %>
                        <tr>
                          <td colspan="3" class="text-center">No receptionists available</td>
                        </tr>
                      <% } %>
                      
                </tbody>
            </table>

            <!-- Modal for adding new Receptionist -->
            <div class="modal fade" id="addReceptionistModal" tabindex="-1" aria-labelledby="addReceptionistModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header bg-primary text-white">
                            <h5 class="modal-title" id="addReceptionistModalLabel">
                                <i class="fas fa-user-receptionist"></i> Add New Receptionist
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="/admin/receptionist/add" method="post">
                                <div class="mb-3">
                                    <label for="receptionistName" class="form-label">Fullname</label>
                                    <input type="text" class="form-control" id="receptionistName" name="fullname" placeholder="Enter receptionist's name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="receptionistEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="receptionistEmail" name="email" placeholder="Enter receptionist's email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="receptionistDepartment" class="form-label">Department</label>
                                    <input type="text" class="form-control" id="receptionistDepartment" name="department" placeholder="Enter department" required>
                                </div>
                                <div class="mb-3">
                                    <label for="receptionistShift" class="form-label">Shift</label>
                                    <select class="form-select" id="receptionistShift" name="shift" required>
                                        <option value="" disabled selected>Select shift</option>
                                        <option value="morning">Morning</option>
                                        <option value="afternoon">Afternoon</option>
                                        <option value="night">Night</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i> Save Receptionist
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <!-- Patient Management Section -->
        <section id="managePatients" class="section-content" style="display:none;">
            <h2 class="section-title">Manage Patients</h2>
            <!-- Table to display doctors -->
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Fullname</th>
                        <th>Email</th>
                        <th>Address</th>
                        <th>PhoneNumber</th>
                    </tr>
                </thead>
                <tbody>
                    <%
                    
                        if(patients && patients.length>0){
                            patients.forEach((patient)=>{
                                %>
                                <tr>
                                    <td><%=patient.fullname%></td>
                                    <td><%=patient.email%></td>
                                    <td><%=patient.address%></td>
                                    <td><%=patient.phoneNumber%></td>
                                </tr>
                                <%
                            })
                        }

                    %>
                </tbody>
            </table>
        </section>

        <section id="manageSurgery" class="section-content" style="display:none;">
            <h2>Manage Surgery</h2>
            <table class="table table-striped table-hover table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>ID</th>
                        <th>Patient</th>
                        <th>Surgery Service</th>
                        <th>Surgery Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="surgeryTableBody">
                    <% if (SurgeryRegistrationLS && SurgeryRegistrationLS.length > 0) { %>
                        <% SurgeryRegistrationLS.forEach((item) => { %>
                            <tr>
                                <td><%= item._id %></td>
                                <td><%= item.patient.fullname %></td>
                                <td><%= item.surgeryService.name %></td>
                                <td><%= new Date(item.surgeryDate).toLocaleDateString() %></td>
                                <td>
                                    <span 
                                        class="badge 
                                        <%= item.status === 'Pending' ? 'bg-warning text-dark' : '' %>
                                        <%= item.status === 'Scheduled' ? 'bg-info text-dark' : '' %>
                                        <%= item.status === 'Completed' ? 'text-success' : '' %>
                                        <%= item.status === 'Cancelled' ? 'text-danger' : '' %>">
                                        <%= item.status %>
                                    </span>
                                </td>
                                <td>
                                    <% if (item.status === 'Pending') { %>
                                        <button class="btn btn-sm btn-success"><a style="color:white; text-decoration: none;" href="/admin/surgery/status/<%=item._id%>/Scheduled">Accept</a></button>
                                        <button class="btn btn-sm btn-warning"><a style="color:white; text-decoration: none;" href="/admin/surgery/status/<%=item._id%>/Cancelled">Cancel</a></button>
                                    <% } else if (item.status === 'Scheduled') { %>
                                        <!-- Button to Trigger Modal -->
                                        <button type="button" class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#selectDoctorModal" 
                                        onclick = "handleSurgeonModel('<%=item._id%>','<%=item.surgeons && item.surgeons.length > 0 ? item.surgeons : [] %>',)"
                                        >
                                            Select Surgeon
                                        </button>
                                    <% } else if (item.status === 'Completed') { %>
                                        <!-- Button to Trigger Modal -->
                                        <button type="button" class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#selectDoctorModal" 
                                        onclick = "handleSurgeonModel('<%=item._id%>','<%=item.surgeons && item.surgeons.length > 0 ? item.surgeons : [] %>', '<%= item.status %>')"
                                        >
                                            Surgeon
                                        </button>
                                    <% } %>
                                </td>
                            </tr>
                        <% }) %>
                    <% } %>
                </tbody>
            </table>            
        </section>        
        
        
        <section id="manageRoom" class="section-content" style="display:none;">
            <div class="container mt-4">
              <h2 class="text-center mb-4"><i class="bi bi-door-open"></i> Room Management</h2>
              <!-- Add Room Button -->
              <div class="d-flex justify-content-end mb-3">
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addRoomModal" onclick = "changeFormForAdd()">
                    <i class="bi bi-plus-circle"></i> Add Room
                </button>
              </div>
              <!-- Room Table -->
              <div class="table-responsive">
                <table class="table table-striped table-bordered text-center">
                  <thead class="table-dark">
                    <tr>
                      <th>#</th>
                      <th>Room Name</th>
                      <th>Bed Count</th>
                      <th>Empty Beds</th>
                      <th>Bed Price/Day</th>
                      <th>Room Type</th>
                      <th>Nurse</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <%
                    
                        if(rooms && rooms.length>0){
                            rooms.forEach((room, index)=>{
                                %>
                                <tr>
                                    <td><%=index+1%></td>
                                    <td><%=room.name%></td>
                                    <td><%=room.bedCount%></td>
                                    <td><%=room.emptyBeds%></td>
                                    <td>$ <%=room.bedPricePerDay%></td>
                                    <td><%=room.roomType%></td>
                                    <td><%
                                        if(nurses && nurses.length > 0){
                                            nurses.forEach((n)=>{
                                                if(n._id.toString() === room.nurseId._id.toString()){
                                                    %>
                                                    <%= n.user.fullname %>
                                                    <%
                                                }
                                            })
                                        }
                                        %></td>
                                    <td>
                                      <button class="btn btn-primary btn-sm" 
                                      onclick="changeFormForEdit('<%= JSON.stringify(room) %>')"
                                      data-bs-toggle="modal" data-bs-target="#addRoomModal"
                                      >
                                        <i class="bi bi-pencil"></i> Edit
                                      </button>
                                      <button class="btn btn-danger btn-sm" onclick="createDeleteModelConfirm('<%=room._id%>')">
                                        <i class="bi bi-trash"></i> Delete
                                      </button>
                                    </td>
                                </tr>
                                <%
                            })
                        }

                    %>
                  </tbody>
                </table>
              </div>
            </div>
          </section>          
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
            <h5 class="modal-title" id="deleteConfirmModalLabel">Confirm Deletion</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
            <p>Are you sure you want to delete this room?</p>
            </div>
            <!-- Modal Footer -->
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <a id="deleteRoomLink" href="#" class="btn btn-danger">Delete</a>
            </div>
        </div>
        </div>
    </div>
  

    <!-- Add Room Modal -->
    <div class="modal fade" id="addRoomModal" tabindex="-1" aria-labelledby="addRoomModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
            <h5 class="modal-title" id="addRoomModalLabel"><i class="bi bi-door-open"></i> Create New Room</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
            <form id="addRoomForm" action="/admin/room/create" method="post">
                <!-- Room Name -->
                <div class="mb-3">
                <label for="roomName" class="form-label">Room Name</label>
                <input type="text" class="form-control" id="roomName" name="roomName" placeholder="Enter room name" required>
                </div>
                <!-- Bed Count -->
                <div class="mb-3">
                <label for="bedCount" class="form-label">Total Beds</label>
                <input type="number" class="form-control" id="bedCount" name="bedCount" placeholder="Enter total beds" min="1" required>
                </div>
                <!-- Empty Beds -->
                <div class="mb-3">
                <label for="emptyBeds" class="form-label">Empty Beds</label>
                <input type="number" class="form-control" id="emptyBeds" name="emptyBeds" placeholder="Enter empty beds" min="0" required>
                </div>
                <!-- Bed Price Per Day -->
                <div class="mb-3">
                <label for="bedPrice" class="form-label">Price Per Bed/Day</label>
                <input type="number" class="form-control" id="bedPrice" name="bedPrice" placeholder="Enter price per bed/day" min="0" required>
                </div>
                <!-- Room Type -->
                <div class="mb-3">
                <label for="roomType" class="form-label">Room Type</label>
                <select class="form-select" id="roomType" name="roomType" required>
                    <option value="">Select Room Type</option>
                    <option value="VIP">VIP</option>
                    <option value="Basic">Basic</option>
                </select>
                </div>
                <!-- Nurse -->
                <div class="mb-3">
                <label for="nurseId" class="form-label">Nurse</label>
                <select class="form-select" id="nurseId" name="nurseId" required>
                    <option value="">Select Nurse</option>
                    <%
                        if(nurses && nurses.length > 0){
                            nurses.forEach((item)=>{
                                %>
                                <option value="<%=item._id%>"><%=item.user.fullname%></option>
                                <%
                            })
                        }
                    %>
                </select>
                </div>
            </form>
            </div>
            <!-- Modal Footer -->
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-success" form="addRoomForm">Save Room</button>
            </div>
        </div>
        </div>
    </div>

    <!-- Modal Structure -->
    <div class="modal fade" id="selectDoctorModal" tabindex="-1" aria-labelledby="selectDoctorLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="selectDoctorLabel">
                        <i class="bi bi-person-bounding-box me-2"></i>Select Surgeon
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="" method="post" id="selectDoctorForm">
                        <div class="mb-3">
                            <label for="doctorList" class="form-label fw-bold">
                                <i class="bi bi-people-fill me-2 text-info"></i>Available Doctors:
                            </label>
                            <div id="doctorList">
                                <% if (doctors && doctors.length > 0) { %>
                                    <% doctors.forEach((doctor) => { %>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" name="surgeons" value="<%= doctor._id %>" id="doctor<%= doctor._id %>">
                                            <label class="form-check-label" for="doctor<%= doctor._id %>">
                                                <i class="bi bi-person-circle me-2 text-success"></i><%= doctor.user.fullname %> 
                                                <span class="badge bg-secondary ms-2"><%= doctor.specialization %></span>
                                            </label>
                                        </div>
                                    <% }) %>
                                <% } else { %>
                                    <p class="text-danger">
                                        <i class="bi bi-exclamation-circle-fill me-2"></i>No doctors available.
                                    </p>
                                <% } %>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="bi bi-x-circle me-1"></i>Close
                            </button>
                            <button type="submit" class="btn btn-primary" id="saveSelectedDoctors">
                                <i class="bi bi-check-circle me-1"></i>Save
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    


    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <script src="/javascripts/admin.js"></script>
    <script>
        // Hàm xử lý việc thay đổi form cho việc chỉnh sửa thông tin phòng
        function changeFormForEdit(roomData) {
             // Cập nhật tiêu đề modal cho Edit Room
            document.getElementById("addRoomModalLabel").innerHTML = "<i class='bi bi-door-open'></i> Edit Room";
            // Parse JSON object
            const room = JSON.parse(roomData);
            // Gán giá trị cho các trường trong form modal
            document.getElementById("roomName").value = room.name;
            document.getElementById("bedCount").value = room.bedCount;
            document.getElementById("emptyBeds").value = room.emptyBeds;
            document.getElementById("bedPrice").value = room.bedPricePerDay;
            document.getElementById("roomType").value = room.roomType;

            // Cập nhật lại thông tin của y tá, nếu có (thực hiện giống như gán nurseId trong form)
            const nurseSelect = document.getElementById("nurseId");
            const sellectItems = nurseSelect.querySelectorAll(`option`);
            if(sellectItems && sellectItems.length > 0){
                sellectItems.forEach((item)=>{
                    if(item.value.toString() == room.nurseId._id.toString()){
                        item.selected  = true;
                    }else{
                        item.selected  = false;
                    }
                })
            }
            
            // Cập nhật action của form để thực hiện hành động sửa
            const form = document.getElementById("addRoomForm");
            form.action = `/admin/room/update/${room._id}`; // Cập nhật URL action cho việc chỉnh sửa
        }

        function changeFormForAdd() {
            // Làm sạch form
            document.getElementById("addRoomForm").reset();

            // Cập nhật action của form để tạo mới
            document.getElementById("addRoomForm").action = "/admin/room/create";

            // Nếu cần, bạn có thể làm thêm một số thay đổi, ví dụ như chọn phòng cơ bản là mặc định
            document.getElementById("roomType").value = "Basic";  // Mặc định là loại phòng Basic

            document.getElementById("emptyBeds").value = 0;

            // Cập nhật tiêu đề modal cho Add Room
            document.getElementById("addRoomModalLabel").innerHTML = "<i class='bi bi-door-open'></i> Create New Room";
        }

        function createDeleteModelConfirm(roomId) {
            // Set the delete URL to the `href` of the confirmation button
            const deleteUrl = `/admin/room/delete/${roomId}`;
            document.getElementById('deleteRoomLink').setAttribute('href', deleteUrl);

            // Show the modal
            const deleteModal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));
            deleteModal.show();
        }

    </script>
</body>
</html>
